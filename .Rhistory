scale_colour_manual(name = "Data from SGD north",
values="#0051fd")
#plot
p_rotor +  theme(legend.position = c(0.7,0.9))
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=5,label= "R² = ~ 11 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from SGD north",
values="#0051fd")
#plot
p_rotor +  theme(legend.position = c(0.7,0.9))
#plot
p_rotor +  theme(legend.position = c(0.1,0.9))
#plot
p_rotor +  theme(legend.position = c(0.4,0.9))
#save plot
ggsave("rotor_diameter.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=5,label= "R² = ~ 11 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_rotor +  theme(legend.position = c(0.4,0.9))
#plot
p_rotor +  theme(legend.position = c(0.3,0.9))
#save plot
ggsave("results_of_analysis/rotor_diameter.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = ~ 11 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_rotor +  theme(legend.position = c(0.3,0.9))
summary(lm_rotor)
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = ~ 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_rotor +  theme(legend.position = c(0.3,0.9))
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_rotor +  theme(legend.position = c(0.3,0.9))
########################
#Analysis of hub height#
########################
wts_rlp_nabe <- filter(wts_rlp_distances, nabe_m != "NA")
View(wts_rlp_nabe)
wts_rlp_nabe <- filter(wts_rlp_nabe, nabe_m < 200)
########################
#Analysis of hub height#
########################
wts_rlp_nabe <- filter(wts_rlp_distances, nabe_m != "NA")
View(wts_rlp_nabe)
wts_rlp_nabe <- filter(wts_rlp_nabe, nabe_m < 200)
sum(is.na(wts_rlp_nabe$nabe_m))
mean(wts_rlp_nabe$nabe_m)
#linear model
lm_nabe <- lm(wts_rlp_nabe$nabe_m ~ wts_rlp_nabe$inbetriebnahme)
summary(lm_nabe)
plot(lm_nabe)
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#4500fe") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#4500fe")
#plot
p_rotor +  theme(legend.position = c(0.3,0.9))
#save plot
ggsave("results_of_analysis/rotor_diameter.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
#plot hub height over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot rotor diameter over commissioning date
p_rotor <- ggplot() +
geom_point(data = wts_rlp_rotor, aes(x=inbetriebnahme, y=rotor_m),
size = 0.4, colour = "#4500fe") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Rotor diameter [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#4500fe")
#plot hub height over commissioning date
p_nabe <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_rotor,
aes(x=inbetriebnahme, y=rotor_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_nabe  +  theme(legend.position = c(0.3,0.9))
#plot hub height over commissioning date
p_nabe <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_nabe,
aes(x=inbetriebnahme, y=nabe_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,170) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_nabe  +  theme(legend.position = c(0.3,0.9))
#plot hub height over commissioning date
p_nabe <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_nabe,
aes(x=inbetriebnahme, y=nabe_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,200) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_nabe  +  theme(legend.position = c(0.3,0.9))
#plot hub height over commissioning date
p_nabe <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_nabe,
aes(x=inbetriebnahme, y=nabe_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,250) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_nabe  +  theme(legend.position = c(0.3,0.9))
#plot hub height over commissioning date
p_nabe <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_nabe,
aes(x=inbetriebnahme, y=nabe_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,220) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 68.7 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_nabe  +  theme(legend.position = c(0.3,0.9))
summary(lm_nabe)
#plot hub height over commissioning date
p_nabe <- ggplot() +
geom_point(data = wts_rlp_nabe, aes(x=inbetriebnahme, y=nabe_m),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_nabe,
aes(x=inbetriebnahme, y=nabe_m, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(25,220) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Hub height [m]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
annotate(geom="text",x=as.Date("2025-01-01"),
y=50,label= "R² = 77.9 % \n p-value << 0.001") +
scale_colour_manual(name = "Data from MaStR",
values="#0051fd")
#plot
p_nabe  +  theme(legend.position = c(0.3,0.9))
#save plot
ggsave("results_of_analysis/hub_height.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
#remove WT's that have distance greater than 1000 m equal to zero
wts_rlp_filtered <- filter(wts_rlp_distances, nearest < 1000 & nearest != 0)
#omit NA values
sum(is.na(wts_rlp_filtered$menge_mwh))
wts_rlp_filtered <- na.omit(wts_rlp_filtered)
#filter those with electricity yield smaller than 10 Mwh and small distance
wts_rlp_filtered <- filter(wts_rlp_filtered, menge_mwh > 20)
wts_rlp_filtered <- filter(wts_rlp_filtered, nearest > 30)
#filter out with electricity yield per m2 above 100 kwh/m2
wts_rlp_filtered <- filter(wts_rlp_filtered, kwh_m2 < 100)
#create linear model
lm_e_yield_per_area <- lm(
wts_rlp_filtered$kwh_m2 ~ wts_rlp_filtered$inbetriebnahme)
summary(lm_e_yield_per_area)
plot(lm_e_yield_per_area)
#plot electricity yield per area over commissioning date
p_e_yield_per_area <- ggplot() +
geom_point(data = wts_rlp_filtered, aes(x=inbetriebnahme, y=kwh_m2),
size = 0.4, colour = "#0051fd") +
geom_smooth(data = wts_rlp_filtered,
aes(x=inbetriebnahme, y=kwh_m2, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(0,80) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Electricity yield per area [kWh/m²a]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
geom_hline(yintercept = 27.4, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("2025-01-01"),
y=25,label="Mean of ~ 27.4 kWh/m²a after 2010", size = 2.5) +
geom_hline(yintercept = 33.5, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("1995-01-01"),
y=35.5,label="Predicted mean of  ~ 33.5 kWh/m²a in 2021",
size = 2.5) +
geom_hline(yintercept = 40.5, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("1995-01-01"),
y=42.5,label="Predicted mean of ~ 40.5 kWh/m²a in 2030",
size = 2.5) +
annotate(geom="text",x=as.Date("2025-01-01"),
y=5,label= "R² = ~ 11 % \n p-value << 0.001") +
scale_colour_manual(name = "Joined data from MaStR and amprion",
values="#0051fd")
#plot
p_e_yield_per_area +  theme(legend.position = c(0.7,0.9))
#plot electricity yield per area over commissioning date
p_e_yield_per_area <- ggplot() +
geom_point(data = wts_rlp_filtered, aes(x=inbetriebnahme, y=kwh_m2),
size = 0.4, colour = "#0074ff") +
geom_smooth(data = wts_rlp_filtered,
aes(x=inbetriebnahme, y=kwh_m2, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(0,80) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Electricity yield per area [kWh/m²a]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
geom_hline(yintercept = 27.4, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("2025-01-01"),
y=25,label="Mean of ~ 27.4 kWh/m²a after 2010", size = 2.5) +
geom_hline(yintercept = 33.5, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("1995-01-01"),
y=35.5,label="Predicted mean of  ~ 33.5 kWh/m²a in 2021",
size = 2.5) +
geom_hline(yintercept = 40.5, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("1995-01-01"),
y=42.5,label="Predicted mean of ~ 40.5 kWh/m²a in 2030",
size = 2.5) +
annotate(geom="text",x=as.Date("2025-01-01"),
y=5,label= "R² = ~ 11 % \n p-value << 0.001") +
scale_colour_manual(name = "Joined data from MaStR and amprion",
values="#0074ff")
#plot
p_e_yield_per_area +  theme(legend.position = c(0.7,0.9))
#save plot
ggsave("e_yield_per_m2_over_commissioning_date.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
#save plot
ggsave("results_of_analysis/e_yield_per_m2_over_commissioning_date.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
#plot electricity yield per area over commissioning date
p_e_yield_per_area <- ggplot() +
geom_point(data = wts_rlp_filtered, aes(x=inbetriebnahme, y=kwh_m2),
size = 0.4, colour = "#00A2ff") +
geom_smooth(data = wts_rlp_filtered,
aes(x=inbetriebnahme, y=kwh_m2, colour = "2019"),
method=lm, se=TRUE, fullrange = TRUE, size = 0.5)  +
theme_light() +
ylim(0,80) +
scale_x_date(limits = as.Date(c("1990-01-01","2030-12-31"))) +
xlab("Commissioning date") +
ylab("Electricity yield per area [kWh/m²a]") +
theme( axis.text=element_text(size=11),
axis.title=element_text(size=12),
plot.title = element_text(size=14),
legend.position = c(0.85, 0.9),
legend.direction = "horizontal") +
geom_hline(yintercept = 27.4, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("2025-01-01"),
y=25,label="Mean of ~ 27.4 kWh/m²a after 2010", size = 2.5) +
geom_hline(yintercept = 33.5, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("1995-01-01"),
y=35.5,label="Predicted mean of  ~ 33.5 kWh/m²a in 2021",
size = 2.5) +
geom_hline(yintercept = 40.5, linetype = 'dashed', size = 0.25) +
annotate(geom="text",x=as.Date("1995-01-01"),
y=42.5,label="Predicted mean of ~ 40.5 kWh/m²a in 2030",
size = 2.5) +
annotate(geom="text",x=as.Date("2025-01-01"),
y=5,label= "R² = ~ 11 % \n p-value << 0.001") +
scale_colour_manual(name = "Joined data from MaStR and amprion",
values="#00A2ff")
#plot
p_e_yield_per_area +  theme(legend.position = c(0.7,0.9))
#save plot
ggsave("results_of_analysis/e_yield_per_m2_over_commissioning_date.png",
plot = last_plot(),
dpi = 900,
width = 7,
height = 4)
4157037/1000000
citation()
1203+1698
8317+8330+2901
setwd("C:/Users/Dell/Desktop/MasterThesis/thesis_elias_cuadra_219202265")
